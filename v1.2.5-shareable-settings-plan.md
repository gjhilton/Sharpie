# v1.2.5: Shareable Settings Implementation Plan

## User Stories

### US-1: View Current Settings Summary

**As a** user configuring game options
**I want to** see a summary of my current settings displayed as badges
**So that** I can quickly understand my current configuration at a glance

**Acceptance Criteria:**

- Badge displays for game mode (ALL/minuscules/MAJUSCULES)
- Badge displays for number of alphabets selected
- Badge displays for 24 vs 26 letter setting
- Badge displays for baseline on/off setting
- Badges section is always visible (even when Options section is collapsed)
- Badges update immediately when settings change

### US-2: Copy Shareable URL

**As a** user who has customized my settings
**I want to** copy a shareable URL to my clipboard
**So that** I can share my configuration with others via email, chat, or social media

**Acceptance Criteria:**

- Read-only text input displays the full shareable URL
- Copy button is visible next to the URL input
- Clicking copy button copies URL to clipboard
- Success feedback (toast) is shown after copying
- URL includes current window.location.origin
- URL contains all current settings as query parameters

### US-3: Load Settings from Shared URL

**As a** user who received a shared settings URL
**I want to** open the URL and have the settings automatically applied
**So that** I can use the same configuration as the person who shared it

**Acceptance Criteria:**

- Opening a URL with query parameters loads those settings
- Settings are applied before the page fully renders
- All option types (mode, alphabets, letters, baseline) are correctly restored
- Invalid/unknown parameters are ignored gracefully

---

## Technical Tasks

### Phase 1: Create OptionsSummary Component

#### Task 1.1: Create component structure

- [ ] Create `src/components/OptionsSummary/OptionsSummary.jsx`
- [ ] Set up basic component structure with props: `{ options, characterCount, alphabetCount }`
- [ ] Add CSS-in-JS styling for badges and URL container
- [ ] Export component with named export

#### Task 1.2: Implement badge generation logic

- [ ] Create function to convert options to badge data array
- [ ] Map game mode to badge labels:
    - `all` → "ALL" or "minuscules + MAJUSCULES"
    - `minuscule` → "minuscules only"
    - `majuscule` → "MAJUSCULES only"
- [ ] Create alphabet count badge: "{count} alphabets" or "{count} alphabet"
- [ ] Create letter badge: "24 letters" or "26 letters" based on twentyFourLetterAlphabet
- [ ] Create baseline badge: "Baselines ON" or "Baselines OFF"
- [ ] Style badges with appropriate colors/icons

#### Task 1.3: Implement URL generation

- [ ] Create function to generate shareable URL
- [ ] Use `window.location.origin + window.location.pathname`
- [ ] Import and use `serializeOptions()` from `@lib/options/serializer.js`
- [ ] Construct search params from serialized options
- [ ] Format as complete URL string

#### Task 1.4: Implement copy-to-clipboard functionality

- [ ] Add copy button with appropriate icon/label
- [ ] Implement clipboard API: `navigator.clipboard.writeText(url)`
- [ ] Add fallback for older browsers (create temp textarea, select, execCommand)
- [ ] Show success feedback (e.g., "Copied!" message, button state change)
- [ ] Reset success feedback after 2-3 seconds
- [ ] Handle errors gracefully (show error message if copy fails)

#### Task 1.5: Create read-only URL input

- [ ] Add text input or textarea for URL display
- [ ] Make it read-only but selectable
- [ ] Style appropriately (monospace font, subtle border)
- [ ] Consider truncation for very long URLs with tooltip showing full URL

---

### Phase 2: Update DisclosureSection Component

#### Task 2.1: Add summaryComponent prop

- [ ] Update `src/components/DisclosureSection/DisclosureSection.jsx`
- [ ] Add optional `additionalComponent` prop to component signature

#### Task 2.2: Render summaryComponent

- [ ] Position summaryComponent below the title/expand button
- [ ] Ensure it renders when section is collapsed
- [ ] Add appropriate spacing/margins
- [ ] Test with and without summaryComponent provided

---

### Phase 3: Integrate into LandingScreen

#### Task 3.1: Import and configure OptionsSummary

- [ ] Update `src/components/LandingScreen/LandingScreen.jsx`
- [ ] Import OptionsSummary component
- [ ] Get characterCount and alphabetCount values (already available)
- [ ] Pass options to OptionsSummary

#### Task 3.2: Update Options DisclosureSection

- [ ] Add summaryComponent prop to Options DisclosureSection
- [ ] Pass OptionsSummary component with required props
- [ ] Verify rendering when collapsed and expanded

---

### Phase 4: Testing

#### Task 4.1: Create OptionsSummary unit tests

- [ ] Create `src/components/OptionsSummary/OptionsSummary.test.jsx`
- [ ] Test badge rendering for different mode values
- [ ] Test alphabet count badge (singular/plural)
- [ ] Test letter badge (24 vs 26)
- [ ] Test baseline badge (on vs off)
- [ ] Test URL generation with default settings
- [ ] Test URL generation with custom settings
- [ ] Test copy button click
- [ ] Mock clipboard API and verify it's called
- [ ] Test success feedback display
- [ ] Test error handling for clipboard failures

#### Task 4.2: Update DisclosureSection tests

- [ ] Update `src/components/DisclosureSection/DisclosureSection.test.jsx`
- [ ] Test rendering with summaryComponent prop
- [ ] Test rendering without summaryComponent prop
- [ ] Verify summaryComponent displays when collapsed
- [ ] Verify summaryComponent displays when expanded

#### Task 4.3: Update LandingScreen tests

- [ ] Update `src/components/LandingScreen/LandingScreen.test.jsx`
- [ ] Add mock for OptionsSummary component
- [ ] Verify OptionsSummary is rendered in Options section
- [ ] Verify correct props are passed to OptionsSummary

#### Task 4.4: Create/update E2E tests

- [ ] Create test: Navigate to landing page with default settings
- [ ] Verify badges display correctly
- [ ] Change settings and verify badges update
- [ ] Click copy button and verify success feedback
- [ ] Create test: Navigate to URL with query params
- [ ] Verify settings are loaded correctly
- [ ] Verify badges match the loaded settings

---

### Phase 5: Polish and Documentation

#### Task 5.1: Styling refinements

- [ ] Ensure badges are visually distinct but cohesive
- [ ] Add hover states for copy button
- [ ] Ensure responsive design (mobile-friendly)
- [ ] Test color contrast for accessibility
- [ ] Add aria-labels for screen readers

#### Task 5.2: Create OptionsSummary stories

- [ ] Create `src/components/OptionsSummary/OptionsSummary.stories.jsx`
- [ ] Story: Default settings
- [ ] Story: Custom mode (minuscules only)
- [ ] Story: Custom alphabets (limited selection)
- [ ] Story: All custom settings
- [ ] Story: Copy button interaction

#### Task 5.3: Update version and changelog

- [ ] Update `package.json` version from 1.2.4 to 1.2.5
- [ ] Add entry to `src/data/changelog.json`:
    ```json
    {
    	"version": "1.2.5",
    	"description": "Shareable settings: Options section now displays current settings as visual badges with a shareable URL and copy-to-clipboard functionality, making it easy to share game configurations with others."
    }
    ```

---

## Implementation Details

### Component Architecture

```
LandingScreen
├── DisclosureSection (title="Options", additionalComponent={<OptionsSummary />})
│   ├── [Title + Expand Button]
│   ├── OptionsSummary ← NEW
│   │   ├── Badge: Game Mode
│   │   ├── Badge: Alphabet Count
│   │   ├── Badge: 24/26 Letters
│   │   ├── Badge: Baselines
│   │   ├── URL Input (read-only)
│   │   └── Copy Button
│   └── OptionsSection (when expanded)
│       ├── Mode selector
│       ├── Alphabet selector
│       ├── 24-letter toggle
│       └── Baseline toggle
```

### Data Flow

1. **LandingScreen** gets options from `useGameOptions()`
2. Passes options + counts to **OptionsSummary**
3. **OptionsSummary** generates:
    - Badges from options object
    - Shareable URL from options + current location
4. User clicks copy → clipboard API called
5. Success feedback shown

### URL Format Examples

```
Default (all enabled):
https://example.com/

Minuscules only, 2 alphabets, 24 letters, no baselines:
https://example.com/?m=i&a=001,002&l=1&b=0

Majuscules only, all alphabets, 26 letters, baselines:
https://example.com/?m=j&l=0
```

### Badge Design Sketch

```
┌─────────────────────────────────────────────────────┐
│ Options                                          [▼] │
├─────────────────────────────────────────────────────┤
│ [ALL] [4 alphabets] [24 letters] [Baselines ON]    │
│                                                     │
│ Shareable link:                                    │
│ ┌────────────────────────────────────┐ [Copy]     │
│ │ https://example.com/?m=a&a=001,... │            │
│ └────────────────────────────────────┘             │
└─────────────────────────────────────────────────────┘
```

---

## Dependencies

- **Existing code to leverage:**
    - `src/lib/options/serializer.js` - `serializeOptions()`
    - `src/lib/options/schema.js` - OPTIONS schema
    - `src/lib/hooks/useGameOptions.js` - `useGameOptions()` hook
    - `src/context/GameOptionsContext.jsx` - Options context

- **Browser APIs:**
    - `navigator.clipboard.writeText()` (with fallback)
    - `window.location.origin` and `window.location.pathname`

- **No new npm packages needed**

---

## Testing Checklist

### Manual Testing

- [ ] Load page with default settings → verify badges show defaults
- [ ] Change mode → verify mode badge updates
- [ ] Change alphabets → verify alphabet count badge updates
- [ ] Toggle 24-letter → verify letter badge updates
- [ ] Toggle baselines → verify baseline badge updates
- [ ] Copy URL → verify clipboard contains correct URL
- [ ] Copy URL → verify success feedback shows
- [ ] Paste URL in new tab → verify settings are loaded
- [ ] Test on mobile device → verify responsive design
- [ ] Test with screen reader → verify accessibility

### Automated Testing

- [ ] All unit tests pass (npm run test:run)
- [ ] All E2E tests pass (npm run test:e2e)
- [ ] Storybook builds successfully (npm run build-storybook)
- [ ] No console errors or warnings
- [ ] No TypeScript/ESLint errors

---

## Rollout Plan

1. **Development**
    - Complete Phases 1-3 (component creation and integration)
    - Local testing and iteration

2. **Testing**
    - Complete Phase 4 (all automated tests)
    - Manual testing checklist
    - Review with stakeholders

3. **Polish**
    - Complete Phase 5 (styling, stories, docs)
    - Accessibility audit
    - Performance check

4. **Release**
    - Update version and changelog
    - Create git commit
    - Deploy to production
    - Monitor for issues

---

## Success Metrics

- Users can identify their current settings at a glance (badges visible)
- Copy-to-clipboard works in 99%+ of browsers
- Shared URLs correctly restore all settings
- No increase in page load time
- Zero accessibility violations
- Positive user feedback on feature discoverability

---

## Future Enhancements (Out of Scope for v1.2.5)

- QR code generation for mobile sharing
- "Reset to defaults" button in OptionsSummary
